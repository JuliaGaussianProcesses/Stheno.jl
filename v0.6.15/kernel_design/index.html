<!DOCTYPE html><HTML lang="en"><head><meta charset="UTF-8"/><meta content="width=device-width, initial-scale=1.0" name="viewport"/><title>Kernel Design · Stheno.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script data-main="../assets/documenter.js" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/><script data-outdated-warner="">function maybeAddWarning () {
    const head = document.getElementsByTagName('head')[0];

    // Add a noindex meta tag (unless one exists) so that search engines don't index this version of the docs.
    if (document.body.querySelector('meta[name="robots"]') === null) {
        const meta = document.createElement('meta');
        meta.name = 'robots';
        meta.content = 'noindex';

        head.appendChild(meta);
    };

    // Add a stylesheet to avoid inline styling
    const style = document.createElement('style');
    style.type = 'text/css';
    style.appendChild(document.createTextNode('.outdated-warning-overlay {  position: fixed;  top: 0;  left: 0;  right: 0;  box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);  z-index: 999;  background-color: #ffaba7;  color: rgba(0, 0, 0, 0.7);  border-bottom: 3px solid #da0b00;  padding: 10px 35px;  text-align: center;  font-size: 15px; }  .outdated-warning-overlay .outdated-warning-closer {    position: absolute;    top: calc(50% - 10px);    right: 18px;    cursor: pointer;    width: 12px; }  .outdated-warning-overlay a {    color: #2e63b8; }    .outdated-warning-overlay a:hover {      color: #363636; }'));
    head.appendChild(style);

    const div = document.createElement('div');
    div.classList.add('outdated-warning-overlay');
    const closer = document.createElement('div');
    closer.classList.add('outdated-warning-closer');

    // Icon by font-awesome (license: https://fontawesome.com/license, link: https://fontawesome.com/icons/times?style=solid)
    closer.innerHTML = '<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="times" class="svg-inline--fa fa-times fa-w-11" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 352 512"><path fill="currentColor" d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"></path></svg>';
    closer.addEventListener('click', function () {
        document.body.removeChild(div);
    });
    let href = '/stable';
    if (window.documenterBaseURL) {
        href = window.documenterBaseURL + '/../stable';
    }
    div.innerHTML = 'This documentation is not for the latest version. <br> <a href="' + href + '">Go to the latest documentation</a>.';
    div.appendChild(closer);
    document.body.appendChild(div);
};

if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', maybeAddWarning);
} else {
    maybeAddWarning();
};
</script></head><body><nav class="toc"><h1>Stheno.jl</h1><select id="version-selector" onchange="window.location.href=this.value" style="visibility: hidden"></select><form action="../search/" class="search" id="search-form"><input id="search-query" name="q" placeholder="Search docs" type="text"/></form><ul><li><a class="toctext" href="../">Home</a></li><li><a class="toctext" href="../getting_started/">Getting Started</a></li><li><a class="toctext" href="../gp_api/">GP API</a></li><li><a class="toctext" href="../composite_gp_api/">CompositeGP API</a></li><li><a class="toctext" href="../input_types/">Input Types</a></li><li class="current"><a class="toctext" href="">Kernel Design</a><ul class="internal"><li><a class="toctext" href="#Base-Kernels-1">Base Kernels</a></li><li><a class="toctext" href="#Length-scales-and-variances-1">Length scales and variances</a></li><li><a class="toctext" href="#Kernel-Composition-1">Kernel Composition</a></li></ul></li><li><a class="toctext" href="../internals/">Internals</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href="">Kernel Design</a></li></ul><a class="edit-page" href="https://github.com/willtebbutt/Stheno.jl/blob/master/docs/src/kernel_design.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Kernel Design</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" href="#Kernel-Design-1" id="Kernel-Design-1">Kernel Design</a></h1><p>Stheno.jl provides a compositional approach to providing all of the usual niceties for kernel construction. We outline the basic kernels, how you can choose their length scales / variances, and the ways in which you can combine them.</p><p>The interface to use the kernels to compute things isn't strictly user-facing, so please refer to the <code>Internals</code> section on kernels for more info about doing things with a kernel once you've built it.</p><h2><a class="nav-anchor" href="#Base-Kernels-1" id="Base-Kernels-1">Base Kernels</a></h2><p>Stheno maintains a diverse collection of so-called "base" kernels. These include, but are not limited to, the</p><ul><li>exponentiated quadratic a.k.a. squared exponential, radial basis function (RBF)</li><li>various matern kernels</li><li>rational quadratic</li></ul><p>All of these base kernels have unit length scale and variance by default. We'll see shortly how to move beyond this.</p><p>The collection of base kernels can be found in <code>src/GP/kernels.jl</code> – at any given point in time it should be considered the definitive source of knowledge regarding the available base kernels. Their implementations are simple, so it's highly recommended to take a look to see what's available.</p><h2><a class="nav-anchor" href="#Length-scales-and-variances-1" id="Length-scales-and-variances-1">Length scales and variances</a></h2><p>As discussed, the base kernels don't come equipped with any notion of a length scale of variance. It's simple to provide any of them with such properties though. The approach we take here has the distinct benefits of immediately applying to any new kernels that are implemented, so if you decide to implement a new kernel there's no need to worry about its length scale or variance, just implement it assume they're both <code>1</code> and you'll be grand. This is great, as you get ARD and factor-analyis kernels for free when you implement a new kernel!</p><h3><a class="nav-anchor" href="#Kernel-Variance-/-Amplitude-1" id="Kernel-Variance-/-Amplitude-1">Kernel Variance / Amplitude</a></h3><p>Given a kernel <code>k</code>, and a desired variance <code>s</code>, we have that</p><pre><code class="language-julia">(s * k)(x, y) = s * k(x, y)</code></pre><p>In other words, <code>s * k</code> returns a new kernel that's the original kernel with a scaled variance.</p><h3><a class="nav-anchor" href="#Length-Scale-1" id="Length-Scale-1">Length Scale</a></h3><p>Given a kernel <code>k</code>, and a desired inverse length scale <code>a</code>, we have that</p><pre><code class="language-julia">stretch(k, a)(x, y) = k(a * x, a * y)</code></pre><p>which, if you do the maths, you'll see is exactly what you needed to do to implement the length scale of a kernel.</p><p>This extends to ARD kernels straightforwardly – just make <code>a</code> an <code>AbstractVector{&lt;:Real}</code>. Furthermore it extends to matrices, enabling learning of a low-dimensional representation of the data.</p><h2><a class="nav-anchor" href="#Kernel-Composition-1" id="Kernel-Composition-1">Kernel Composition</a></h2><p>The core piece of functionality that makes Stheno.jl's kernels work is composition. For example, the <code>Sum</code> kernel lets you write</p><pre><code class="language-julia">k3 = k1 + k2</code></pre><p>and the <code>Product</code> kernel enables</p><pre><code class="language-julia">k3 = k1 * k2</code></pre><p>In fact, the variance and <code>stretch</code> functionality discussed above is implemented in terms of composite kernels. Take a look towards the bottom of the <code>src/GP/kernels.jl</code> file if you're interested how things. The <code>Sum</code> and <code>Product</code> kernels are good places to start here.</p><footer><hr/><a class="previous" href="../input_types/"><span class="direction">Previous</span><span class="title">Input Types</span></a><a class="next" href="../internals/"><span class="direction">Next</span><span class="title">Internals</span></a></footer></article></body></HTML>